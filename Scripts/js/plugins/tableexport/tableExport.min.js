(function(n){n.fn.extend({tableExport:function(t){function e(n){return content_data=i.htmlContent=="true"?n.html().trim():n.text().trim(),i.escape=="true"&&(content_data=escape(content_data)),content_data}var i={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},t=n.extend(i,t),f=this,r,v,y,a,s,h,l,u,o,c,p;if(i.type=="csv"||i.type=="txt")r="",n(f).find("thead").find("tr").each(function(){r+="\n";n(this).filter(":visible").find("th").each(function(t){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1&&(r+='"'+e(n(this))+'"'+i.separator)});r=n.trim(r);r=n.trim(r).substring(0,r.length-1)}),n(f).find("tbody").find("tr").each(function(){r+="\n";n(this).filter(":visible").find("td").each(function(t){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1&&(r+='"'+e(n(this))+'"'+i.separator)});r=n.trim(r).substring(0,r.length-1)}),i.consoleLog=="true"&&console.log(r),o="base64,"+n.base64.encode(r),window.open("data:application/"+i.type+";filename=exportData;"+o);else if(i.type=="sql")r="INSERT INTO `"+i.tableName+"` (",n(f).find("thead").find("tr").each(function(){n(this).filter(":visible").find("th").each(function(t){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1&&(r+="`"+e(n(this))+"`,")});r=n.trim(r);r=n.trim(r).substring(0,r.length-1)}),r+=") VALUES ",n(f).find("tbody").find("tr").each(function(){r+="(";n(this).filter(":visible").find("td").each(function(t){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1&&(r+='"'+e(n(this))+'",')});r=n.trim(r).substring(0,r.length-1)+"),"}),r=n.trim(r).substring(0,r.length-1),r+=";",i.consoleLog=="true"&&console.log(r),o="base64,"+n.base64.encode(r),window.open("data:application/sql;filename=exportData;"+o);else if(i.type=="json")v=[],n(f).find("thead").find("tr").each(function(){var t=[];n(this).filter(":visible").find("th").each(function(r){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(r)==-1&&t.push(e(n(this)))});v.push(t)}),y=[],n(f).find("tbody").find("tr").each(function(){var t=[];n(this).filter(":visible").find("td").each(function(r){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(r)==-1&&t.push(e(n(this)))});y.push(t)}),a=[],a.push({header:v,data:y}),i.consoleLog=="true"&&console.log(JSON.stringify(a)),o="base64,"+n.base64.encode(JSON.stringify(a)),window.open("data:application/json;filename=exportData;"+o);else if(i.type=="xml")s='<?xml version="1.0" encoding="utf-8"?>',s+="<tabledata><fields>",n(f).find("thead").find("tr").each(function(){n(this).filter(":visible").find("th").each(function(t){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1&&(s+="<field>"+e(n(this))+"<\/field>")})}),s+="<\/fields><data>",l=1,n(f).find("tbody").find("tr").each(function(){s+='<row id="'+l+'">';var t=0;n(this).filter(":visible").find("td").each(function(r){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(r)==-1&&(s+="<column-"+t+">"+e(n(this))+"<\/column-"+t+">");t++});l++;s+="<\/row>"}),s+="<\/data><\/tabledata>",i.consoleLog=="true"&&console.log(s),o="base64,"+n.base64.encode(s),window.open("data:application/xml;filename=exportData;"+o);else if(i.type=="excel"||i.type=="doc"||i.type=="powerpoint")h="<table>",n(f).find("thead").find("tr").each(function(){h+="<tr>";n(this).filter(":visible").find("th").each(function(t){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1&&(h+="<td>"+e(n(this))+"<\/td>")});h+="<\/tr>"}),l=1,n(f).find("tbody").find("tr").each(function(){h+="<tr>";var t=0;n(this).filter(":visible").find("td").each(function(r){n(this).css("display")!="none"&&i.ignoreColumn.indexOf(r)==-1&&(h+="<td>"+e(n(this))+"<\/td>");t++});l++;h+="<\/tr>"}),h+="<\/table>",i.consoleLog=="true"&&console.log(h),u="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+i.type+"' xmlns='http://www.w3.org/TR/REC-html40'>",u+="<head>",u+="<!--[if gte mso 9]>",u+="<xml>",u+="<x:ExcelWorkbook>",u+="<x:ExcelWorksheets>",u+="<x:ExcelWorksheet>",u+="<x:Name>",u+="{worksheet}",u+="<\/x:Name>",u+="<x:WorksheetOptions>",u+="<x:DisplayGridlines/>",u+="<\/x:WorksheetOptions>",u+="<\/x:ExcelWorksheet>",u+="<\/x:ExcelWorksheets>",u+="<\/x:ExcelWorkbook>",u+="<\/xml>",u+="<![endif]-->",u+="<\/head>",u+="<body>",u+=h,u+="<\/body>",u+="<\/html>",o="base64,"+n.base64.encode(u),window.open("data:application/vnd.ms-"+i.type+";filename=exportData.doc;"+o);else if(i.type=="png")html2canvas(n(f),{onrendered:function(n){var t=n.toDataURL("image/png");window.open(t)}});else if(i.type=="pdf"){c=new jsPDF("p","pt","a4",!0);c.setFontSize(i.pdfFontSize);p=i.pdfLeftMargin;n(f).find("thead").find("tr").each(function(){n(this).filter(":visible").find("th").each(function(t){if(n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1){var r=p+t*50;c.text(r,20,e(n(this)))}})});var w=20,b=1,k=0;n(f).find("tbody").find("tr").each(function(t){rowCalc=t+1;rowCalc%26==0&&(c.addPage(),b++,w=w+10);k=w+rowCalc*10-(b-1)*280;n(this).filter(":visible").find("td").each(function(t){if(n(this).css("display")!="none"&&i.ignoreColumn.indexOf(t)==-1){var r=p+t*50;c.text(r,k,e(n(this)))}})});c.output("datauri")}}})})(jQuery);
//# sourceMappingURL=tableExport.min.js.map
